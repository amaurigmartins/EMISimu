function [strbranch] = writeLCCBranchCard(app,sec)

num_nodes=getNumPhases(app)+getNumShieldWires(app);

seq_in='ABC';
seq_out=valIfTrue(app,isTranspositionTower(app,sec),'CAB','ABC');

switch num_nodes
    case 3 % 1 circuit, no shield wire
        strbranch=sprintf('BRANCH  1%04d%s1%04d%s1%04d%s1%04d%s1%04d%s1%04d%s', ...
            sec-1,seq_in(1),sec,seq_out(1), ...
            sec-1,seq_in(2),sec,seq_out(2), ...
            sec-1,seq_in(3),sec,seq_out(3));
        
    case 4 % 1 circuit, one shield wire
        strbranch=sprintf('BRANCH  1%04d%s1%04d%s1%04d%s1%04d%s1%04d%s1%04d%s0%05d0%05d', ...
            sec-1,seq_in(1),sec,seq_out(1), ...
            sec-1,seq_in(2),sec,seq_out(2), ...
            sec-1,seq_in(3),sec,seq_out(3), ...
            sec-1,sec);
        
    case 5 % 1 circuit, two shield wires
        strbranch=sprintf('BRANCH  1%04d%s1%04d%s1%04d%s1%04d%s1%04d%s1%04d%s0%05d0%05d', ...
            sec-1,seq_in(1),sec,seq_out(1), ...
            sec-1,seq_in(2),sec,seq_out(2), ...
            sec-1,seq_in(3),sec,seq_out(3), ...
            sec-1,sec);
        
    case 6 % 2 circuits, no shield wire
        strbranch=sprintf('BRANCH  1%04d%s1%04d%s1%04d%s1%04d%s1%04d%s1%04d%s2%04d%s2%04d%s2%04d%s2%04d%s2%04d%s2%04d%s', ...
            sec-1,seq_in(1),sec,seq_out(1), ...
            sec-1,seq_in(2),sec,seq_out(2), ...
            sec-1,seq_in(3),sec,seq_out(3), ...
            sec-1,seq_in(1),sec,seq_out(1), ...
            sec-1,seq_in(2),sec,seq_out(2), ...
            sec-1,seq_in(3),sec,seq_out(3));
        
    case 7 % 2 circuits, one shield wire
        strbranch=sprintf('BRANCH  1%04d%s1%04d%s1%04d%s1%04d%s1%04d%s1%04d%s2%04d%s2%04d%s2%04d%s2%04d%s2%04d%s2%04d%s\nBRANCH  0%05d0%05d', ...
            sec-1,seq_in(1),sec,seq_out(1), ...
            sec-1,seq_in(2),sec,seq_out(2), ...
            sec-1,seq_in(3),sec,seq_out(3), ...
            sec-1,seq_in(1),sec,seq_out(1), ...
            sec-1,seq_in(2),sec,seq_out(2), ...
            sec-1,seq_in(3),sec,seq_out(3), ...
            sec-1,sec);
        
    case 8 % 2 circuits, two shield wires
        strbranch=sprintf('BRANCH  1%04d%s1%04d%s1%04d%s1%04d%s1%04d%s1%04d%s2%04d%s2%04d%s2%04d%s2%04d%s2%04d%s2%04d%s\nBRANCH  0%05d0%05d', ...
            sec-1,seq_in(1),sec,seq_out(1), ...
            sec-1,seq_in(2),sec,seq_out(2), ...
            sec-1,seq_in(3),sec,seq_out(3), ...
            sec-1,seq_in(1),sec,seq_out(1), ...
            sec-1,seq_in(2),sec,seq_out(2), ...
            sec-1,seq_in(3),sec,seq_out(3), ...
            sec-1,sec);
end

end

